---
title: aliyun远程登录
date: 2018-05-19 15:09:37
tags: aliyun login javascript fullstack
intro: 慢慢折腾吧...
---
>租了一台阿里云最便宜的服务器，于是开始记录新一轮的折腾……

#### 准备工作
- 先把各种密码记下来吧：1.阿里云账户名和密码。2.阿里云服务器实例的管理员名称：root（默认），和登录密码。
- 我是widows，所以要去下载putty，用这个登录远程服务器。
#### 初次尝试连接
- 打开putty，在首页面板的ip地址中输入阿里云控制台里ecs服务器实例信息一栏内的公网ip地址，后面端口号默认22.点击open。
- 在弹出的命令行中按提示输入用户名：root。 之后会提示输入密码，需要我输入服务器的登录密码，输入的时候光标不会移动……完后敲回车，会提示我一些安全信息，输入yes之后就能看到阿里云的欢迎信息了。
#### 新建一个用户
- 由于root用户的权限很大，所以操作时不小心就会搞砸，所以要我新建一个用户。在登录上服务器之后，输入`adduser manager`回车之后就新建了一个叫manager的用户，然后便提示输入一个该用户的登录密码，输入密码时光标还是没有移动，然后就是一些该用户的信息让你补全，可以直接回车。
- 接着给这个用户提升一下权限，输入`gpasswd -a manager sudo`回车
- 还没完，接着输入 `sudo visudo`回车，接着在弹出的一大段文字里面移动到 root ALL= 这一段文字的下面再增加一行文字，用manager替换root，其他保持一样。 这样manager只需提供密码就能和root具有一样的权限了。
- 最后ctrl x 弹出是否保存，输入y保存。这时就可以用这个manager像root一样登录了。
#### 用ssh公私钥免密登录之本地操作
- 因为我使用过github，所以本机上面有ssh的公钥和私钥。现在需要把本机的ssh代理打开，在命令行中输入`eval $(ssh-agent -s)`回车
- 然后把ssh的key加入代理中。输入`ssh-add ~/.ssh/id_rsa` 回车
#### 用ssh公私钥免密登录之服务器端操作
- 现在需要转到服务器的命令行中
- 在服务器的命令行中输入`ssh-keygen -t -rsa -b 4096 -C "输入你的邮箱"`多次回车之后就在服务器生成了公私钥了。现在服务器多了一个.ssh文件夹，里面就有公私钥。
- 输入`eval $(ssh-agent -s)`回车开启ssh代理
- 输入`ssh-add ~/.ssh/id_rsa`回车
- 输入`vi authorized_keys`回车创建认证文件
- 现在需要把本地的公钥给拷到这个文件中。把本地id_rsa.pub文件打开，复制里面的内容。
- 在服务器命令行里面输入`vi authorized_keys`回车打开这个文件。按i键进入输入模式，巴刚才复制的内容粘贴过来。然后按esc键退出输入。
- 按下shift加冒号键，输入`wq!`回车之后就保存了。
- 在服务器命令行中继续输入`chmod 600 authorized_keys`回车授予这个文件权限。
- 接着输入`sudo service ssh restart`

> ok，现在就可以直接在本地命令行中输入 `ssh manager@"公网ip地址"`免密登录了。






